
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.1. Calculation of the degree of inversion of Mg, Al atoms in an ionic crystal \({\rm Mg}{\rm Al}_2 {\rm O}_4\) &#8212; abICS 1.0-beta documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0-beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Input Files Format" href="../inputfiles/index.html" />
    <link rel="prev" title="4. Tutorial" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="calculation-of-the-degree-of-inversion-of-mg-al-atoms-in-an-ionic-crystal">
<h1>4.1. Calculation of the degree of inversion of Mg, Al atoms in an ionic crystal <span class="math">\({\rm Mg}{\rm Al}_2 {\rm O}_4\)</span><a class="headerlink" href="#calculation-of-the-degree-of-inversion-of-mg-al-atoms-in-an-ionic-crystal" title="Permalink to this headline">¶</a></h1>
<p>Input files are provided in <code class="docutils literal"><span class="pre">examples/standard/spinel</span></code> .
Below, examples for QuantumESPRESSO and VASP are described.</p>
<div class="section" id="example-by-using-quantumespresso">
<h2>4.1.1. Example by using QuantumESPRESSO<a class="headerlink" href="#example-by-using-quantumespresso" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preparing-the-input-files-for-abics">
<h3>Preparing the input files for abICS<a class="headerlink" href="#preparing-the-input-files-for-abics" title="Permalink to this headline">¶</a></h3>
<p>The input file of abICS is <code class="docutils literal"><span class="pre">input_qe.toml</span></code> .</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[replica]
nreplicas = 2
nprocs_per_replica = 1

kTstart = 1000.0
kTend = 1200.0

nsteps = 5  # Number of steps for sampling
RXtrial_frequency = 1
sample_frequency = 1
print_frequency = 1
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">[replica]</span></code> is a section for specifying parameters of the replica exchange Monte Carlo method.
In this example, the number of the replicas is 2 and the number of the steps is 5.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[solver]
type = &#39;qe&#39;
path= &#39;./pw.x&#39;
base_input_dir = &#39;./baseinput&#39;
perturb = 0.0
run_scheme = &#39;mpi_spawn&#39;
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">[solver]</span></code> is a section for specifying a solver program.
This examples sets <code class="docutils literal"><span class="pre">type</span></code> as <code class="docutils literal"><span class="pre">qe</span></code> in order to use Quantum ESPRESSO (QE).
<code class="docutils literal"><span class="pre">path</span></code> specifies the path to <code class="docutils literal"><span class="pre">pw.x</span></code>, the SCF energy solver of QE.
The directory that contains the input parameter files specific to each solver is given as <code class="docutils literal"><span class="pre">./baseinput</span></code> using <code class="docutils literal"><span class="pre">base_input_dir</span></code>.
<code class="docutils literal"><span class="pre">perturb</span></code> is a parameter for randomly shifting atomic positions prior to structural optimization (this is useful for avoiding high-symmetry saddle points in the relaxation), but in this example it is set to 0, as we do not perform structural optimization in this example.
abICS starts <code class="docutils literal"><span class="pre">pw.x</span></code> with <code class="docutils literal"><span class="pre">MPI_Comm_spawn</span></code>, so we set <code class="docutils literal"><span class="pre">mpi_spawn</span></code> as <code class="docutils literal"><span class="pre">run_scheme</span></code>.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[config]
unitcell = [[8.1135997772, 0.0000000000, 0.0000000000],
            [0.0000000000, 8.1135997772, 0.0000000000],
            [0.0000000000, 0.0000000000, 8.1135997772]]
supercell = [1,1,1]
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">[config]</span></code> is the atomic position section.
It specifies the simulation cell (In units of angstrom) to be simulated by <code class="docutils literal"><span class="pre">unitcell</span></code> and <code class="docutils literal"><span class="pre">supercell</span></code>.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[[config.base_structure]]
type = &quot;O&quot;
coords = [
     [0.237399980, 0.237399980, 0.237399980],
     [0.762599945, 0.762599945, 0.762599945],
     [0.512599945, 0.012600004, 0.737399936],
     [0.487399966, 0.987399936, 0.262599975],
     [0.012600004, 0.737399936, 0.512599945],
     [0.987399936, 0.262599975, 0.487399966],
     [0.737399936, 0.512599945, 0.012600004],
     [0.262599975, 0.487399966, 0.987399936],
     [0.987399936, 0.487399966, 0.262599975],
     [0.012600004, 0.512599945, 0.737399936],
     [0.487399966, 0.262599975, 0.987399936],
     [0.512599945, 0.737399936, 0.012600004],
     [0.262599975, 0.987399936, 0.487399966],
     [0.737399936, 0.012600004, 0.512599945],
     [0.237399980, 0.737399936, 0.737399936],
     [0.762599945, 0.262599975, 0.262599975],
     [0.512599945, 0.512599945, 0.237399980],
     [0.487399966, 0.487399966, 0.762599945],
     [0.012600004, 0.237399980, 0.012600004],
     [0.987399936, 0.762599945, 0.987399936],
     [0.987399936, 0.987399936, 0.762599945],
     [0.012600004, 0.012600004, 0.237399980],
     [0.487399966, 0.762599945, 0.487399966],
     [0.512599945, 0.237399980, 0.512599945],
     [0.737399936, 0.237399980, 0.737399936],
     [0.262599975, 0.762599945, 0.262599975],
     [0.237399980, 0.512599945, 0.512599945],
     [0.762599945, 0.487399966, 0.487399966],
     [0.762599945, 0.987399936, 0.987399936],
     [0.237399980, 0.012600004, 0.012600004],
     [0.737399936, 0.737399936, 0.237399980],
     [0.262599975, 0.262599975, 0.762599945],
     ]
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">[[config.base_structure]]</span></code> is a section that specifies the atoms that should not be moved in the Monte Carlo calculation.
<code class="docutils literal"><span class="pre">type</span></code> is the name of the atom and <code class="docutils literal"><span class="pre">coords</span></code> is the fraction coordinate where the atom is located.
<code class="docutils literal"><span class="pre">coords</span></code> can be used to give not only a list of lists but also a string representing a numeric matrix with three columns separated by white space and as many rows as there are atoms.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[[config.defect_structure]]
coords = [
     [0.000000000, 0.000000000, 0.000000000],
     [0.749999940, 0.249999985, 0.499999970],
     [0.249999985, 0.749999940, 0.499999970],
     [0.249999985, 0.499999970, 0.749999940],
     [0.749999940, 0.499999970, 0.249999985],
     [0.499999970, 0.749999940, 0.249999985],
     [0.499999970, 0.249999985, 0.749999940],
     [0.000000000, 0.499999970, 0.499999970],
     [0.749999940, 0.749999940, 0.000000000],
     [0.249999985, 0.249999985, 0.000000000],
     [0.249999985, 0.000000000, 0.249999985],
     [0.749999940, 0.000000000, 0.749999940],
     [0.499999970, 0.000000000, 0.499999970],
     [0.000000000, 0.749999940, 0.749999940],
     [0.000000000, 0.249999985, 0.249999985],
     [0.499999970, 0.499999970, 0.000000000],
     [0.374999970, 0.374999970, 0.374999970],
     [0.624999940, 0.624999940, 0.624999940],
     [0.374999970, 0.874999940, 0.874999940],
     [0.624999940, 0.124999993, 0.124999993],
     [0.874999940, 0.874999940, 0.374999970],
     [0.124999993, 0.124999993, 0.624999940],
     [0.874999940, 0.374999970, 0.874999940],
     [0.124999993, 0.624999940, 0.124999993],
     ]
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">[[config.defect_structure]]</span></code> is the section for specifying the positions of the atoms you want to move in the Monte Carlo calculation.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[[config.defect_structure.groups]]
name = &#39;Al&#39;
# species = [&#39;Al&#39;]    # default
# coords = [[[0,0,0]]]  # default
num = 16
[[config.defect_structure.groups]]
name = &#39;Mg&#39;
# species = [&#39;Mg&#39;]    # default
# coords = [[[0,0,0]]]  # default
num = 8
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">[[config.defect_structure.groups]]</span></code> is the section for specifying the name and number of atoms to be moved in the Monte Carlo calculation.
In this example, abICS will sample the possible configurations of 16 <code class="docutils literal"><span class="pre">Al</span></code> and 8 <code class="docutils literal"><span class="pre">Mg</span></code> atoms on the lattice specified by <code class="docutils literal"><span class="pre">[[config.defect_structure]]</span></code>.</p>
</div>
<div class="section" id="preparing-the-input-file-of-qe">
<h3>Preparing the input file of QE<a class="headerlink" href="#preparing-the-input-file-of-qe" title="Permalink to this headline">¶</a></h3>
<p>abICS generates the input files of the solver from the internally-held structure information, but information other than the structure such as pseudopotential information must be supplied by the user.
In the case of QE, such information is specified by <code class="docutils literal"><span class="pre">scf.in</span></code> in the directory specified by <code class="docutils literal"><span class="pre">base_input_dir</span></code> in the format of the input file of <code class="docutils literal"><span class="pre">pw.x</span></code>.
Based on this file, an input file with unit cells and atomic structure is automatically generated.</p>
<ul class="simple">
<li>Notes<ul>
<li>The pseudopotential directory <code class="docutils literal"><span class="pre">pseudo_dir</span></code> must be passed as an absolute path. <code class="docutils literal"><span class="pre">~</span></code> expands to the user’s home directory.</li>
<li><code class="docutils literal"><span class="pre">disk_io</span></code> must not be <code class="docutils literal"><span class="pre">none</span></code> .</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="execution-and-analysis">
<h3>Execution and analysis<a class="headerlink" href="#execution-and-analysis" title="Permalink to this headline">¶</a></h3>
<p>Please refer to <a class="reference internal" href="../how_to_use/index.html#sec-basic-usage"><span class="std std-ref">Basic Usage</span></a> section for information on setting the number of processes and options for running MPI.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>mpiexec -np 2 abics input_qe.toml
</pre></div>
</div>
<p>After the abICS calculation, we can calculate the degree of inversion (DOI: ratio of Al atoms on Mg sites of the ordered spinel structure).
Scripts for performing this analysis are <code class="docutils literal"><span class="pre">separateT.py</span></code> and <code class="docutils literal"><span class="pre">calc_DOI.py</span></code> in the <code class="docutils literal"><span class="pre">examples/standard/spinel</span></code> directory.</p>
<p>First, <code class="docutils literal"><span class="pre">separateT.py</span></code> is used to reorder the structures at each sampling step by temperature:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>mpiexec -np 2 python3 ./separateT.py input_qe.toml
</pre></div>
</div>
<p>The results are stored in the <code class="docutils literal"><span class="pre">Tseparate</span></code> directory.
If this directory already exists, the old one is moved to another directory <code class="docutils literal"><span class="pre">Tseparate.DATE</span></code> (<code class="docutils literal"><span class="pre">DATE</span></code> is the current datetime).</p>
<p>Next, calculate DOI by using <code class="docutils literal"><span class="pre">calc_DOI.py</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>mpiexec -np 2 python3 ./calc_DOI.py input_qe.toml
</pre></div>
</div>
<p>The results are stored in <code class="docutils literal"><span class="pre">Tseparate/DOI_T.dat</span></code> .</p>
<a class="reference internal image-reference" href="../_images/doi_2.png"><img alt="../_images/doi_2.png" class="align-center" src="../_images/doi_2.png" style="width: 400px;" /></a>
<p>If you increase the number of replicas, you can calculate at various temperatures.
You can also get better results by increasing the number of steps.
The first number of samples to discard in Monte Carlo averaging can be specified by the value of <code class="docutils literal"><span class="pre">throwout</span></code> in the <code class="docutils literal"><span class="pre">calc_DOI.py</span></code> script.
For example, if you perform this calculation with 17 replicas and 20 steps, the following result will be obtained</p>
<a class="reference internal image-reference" href="../_images/doi_17.png"><img alt="../_images/doi_17.png" class="align-center" src="../_images/doi_17.png" style="width: 400px;" /></a>
<p>You can see that DOI increases as the temperature increases.</p>
</div>
</div>
<div class="section" id="example-by-using-vasp">
<h2>4.1.2. Example by using VASP<a class="headerlink" href="#example-by-using-vasp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Preparing the input files for abICS<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The input file of abICS is <code class="docutils literal"><span class="pre">input_vasp.toml</span></code> .
Below, <code class="docutils literal"><span class="pre">input_vasp.toml</span></code> in <code class="docutils literal"><span class="pre">examples/standard/spinel</span></code> is explained as an example.
Only the <code class="docutils literal"><span class="pre">[solver]</span></code> section is differnt from that of QuantumESPRESSO.
The <code class="docutils literal"><span class="pre">[solver]</span></code> section is specified as follows:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>[solver]
type = &#39;vasp&#39;
path = &#39;./vasp&#39;
base_input_dir = &#39;./baseinput&#39;
perturb = 0.0
run_scheme = &#39;mpi_spawn_ready&#39;
</pre></div>
</div>
<p>This examples sets <code class="docutils literal"><span class="pre">type</span></code> as <code class="docutils literal"><span class="pre">vasp</span></code> in order to use VASP.
<code class="docutils literal"><span class="pre">path</span></code> specifies the path to <code class="docutils literal"><span class="pre">vasp</span></code>.
The directory that contains the input parameter files specific to each solver is given as <code class="docutils literal"><span class="pre">./baseinput</span></code> using <code class="docutils literal"><span class="pre">base_input_dir</span></code>.
<code class="docutils literal"><span class="pre">perturb</span></code> is a random parameter that shifts atomic positions for structural optimization, but in this example it is set to 0 not to perform structural optimization.</p>
<p>abICS starts <code class="docutils literal"><span class="pre">vasp</span></code> with <code class="docutils literal"><span class="pre">MPI_Comm_spawn</span></code>, so give <code class="docutils literal"><span class="pre">mpi_spawn_ready</span></code> as <code class="docutils literal"><span class="pre">run_scheme</span></code> .To use VASP as a solver, a patch must be applied to use MPI_COMM_SPAWN. If you wish to use it, please contact us (the e-mail address is written in <a class="reference internal" href="../contact/index.html"><span class="doc">Contacts</span></a> .</p>
</div>
<div class="section" id="preparing-the-input-file-of-vasp">
<h3>Preparing the input file of VASP<a class="headerlink" href="#preparing-the-input-file-of-vasp" title="Permalink to this headline">¶</a></h3>
<p>abICS generates the input files of the solver from the internal atomic structure, but information other than the structure, such as pseudopotential information, must be supplied by the user.
In the case of VASP, such information is specified by <code class="docutils literal"><span class="pre">INCAR</span></code>, <code class="docutils literal"><span class="pre">POSCAR</span></code>,  <code class="docutils literal"><span class="pre">KPOINTS</span></code> and <code class="docutils literal"><span class="pre">POTCAR</span></code> in  <code class="docutils literal"><span class="pre">base_input_dir</span></code>. Here, <code class="docutils literal"><span class="pre">POTCAR</span></code> file is not contained in the <code class="docutils literal"><span class="pre">base_input_dir</span></code> due to the VASP license. Before the calculation, generate  <code class="docutils literal"><span class="pre">POTCAR</span></code> file from the <code class="docutils literal"><span class="pre">O,</span> <span class="pre">Al,</span> <span class="pre">Mg</span></code> pesudo potential files.
Based on these files, an input file with unit cells and atomic structure is automatically generated.</p>
<ul class="simple">
<li>Notes<ul>
<li>The coordinate information of <code class="docutils literal"><span class="pre">POSCAR</span></code> will be overwritten by the input information of abICS, but it must be described.</li>
<li>In <code class="docutils literal"><span class="pre">POTCAR</span></code> file, please list pseudo potentials in alphabetical order of atoms.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id2">
<h3>Execution and analysis<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The procedures of execution and analysis are same as those of QE.
If you do with 17 replicas and 1000 steps same as the exapmle of QE, the following result will be obtained</p>
<a class="reference internal image-reference" href="../_images/doi_vasp.png"><img alt="../_images/doi_vasp.png" class="align-center" src="../_images/doi_vasp.png" style="width: 400px;" /></a>
<p>You can see that DOI increases as the temperature increases.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">abICS</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">1. About abICS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">2. Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_to_use/index.html">3. Basic Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">4. Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.1. Calculation of the degree of inversion of Mg, Al atoms in an ionic crystal <span class="math">\({\rm Mg}{\rm Al}_2 {\rm O}_4\)</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../inputfiles/index.html">5. Input Files Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outputfiles/index.html">6. Output Files Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithm/index.html">7. Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledge/index.html">8. Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact/index.html">9. Contacts</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">4. Tutorial</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">4. Tutorial</a></li>
      <li>Next: <a href="../inputfiles/index.html" title="next chapter">5. Input Files Format</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Institute for Solid State Physics, University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../_sources/tutorial/spinel.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>